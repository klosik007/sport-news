{% extends 'base.html.twig' %}

{% block title %}Meczyki.pl{% endblock %}

{% block body %}
    <style>
        .container{ margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    </style>

    <script>
        function checkInputs() {
            let authors = document.getElementById('news_authors') || false;
            let title = document.getElementById('news_title').value.length > 0;
            let text = document.getElementById('news_text').value.length > 0 &&
                       document.getElementById('news_text').value.length <= 255;

            // edit article
            if (!authors || !title || !text) {
                document.getElementById('inputMessage').removeAttribute('hidden');
            }

            // add article
            if (authors) {
                if (authors.value.length === 0 || !title || !text)
                    document.getElementById('inputMessage').removeAttribute('hidden');
            }
        }
    </script>
    <div class="container">
        {% if app.request.get('_route') == 'update_news' %}
            <h2>Edit article</h2>
            <form action="{{ path('update_news', {id: news_data.id}) }}" method="post" id="updateNews">
        {% else %}
            <h2>Add article</h2>
            <form action="{{ path('add_news') }}" method="post" id="addNews">
                <label for="news_authors">
                    Author(s)
                </label>
                <br>
                <select name="news_authors[]" id="news_authors" multiple>
                    {% for key, author in authors %}
                        <option value="{{ key + 1 }}">{{ author.name }}</option>
                    {% endfor %}
                </select>
                <br>
        {% endif %}
            <label for="news_title">
                Title
            </label>
            <br>
            <input type="text" name="news_title" id="news_title" value="{{ news_data.title ?? "" }}" />
            <br>
            <label for="news_text">Content</label>
            <br>
            <textarea name="news_text" id="news_text">{{ news_data.text ?? "" }}</textarea>
            <br>
            <button type="submit" onclick="checkInputs()">
                {% if app.request.get('_route') == 'update_news' %}
                    Edit Post
                {% else %}
                    Add Post
                {% endif %}
            </button>
        </form>
        <p id="inputMessage" hidden>Provide all correct data!</p>
    </div>
{% endblock %}